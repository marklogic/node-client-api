{
    "$optic": {
        "ns": "op",
        "fn": "operators",
        "args": [
            {
                "ns": "op",
                "fn": "from-lexicons",
                "args": [
                    {
                        "uri1": {
                            "uriReference": { }
                        },
                        "city": {
                            "jsonPropertyReference": {
                                "property": "city",
                                "scalarType": "string",
                                "collation": "http://marklogic.com/collation/",
                                "nullable": false
                            }
                        },
                        "popularity": {
                            "jsonPropertyReference": {
                                "property": "popularity",
                                "scalarType": "int",
                                "nullable": false
                            }
                        },
                        "date": {
                            "jsonPropertyReference": {
                                "property": "date",
                                "scalarType": "date",
                                "nullable": false
                            }
                        },
                        "distance": {
                            "jsonPropertyReference": {
                                "property": "distance",
                                "scalarType": "double",
                                "nullable": false
                            }
                        },
                        "point": {
                            "jsonPropertyReference": {
                                "property": "latLonPoint",
                                "scalarType": "point",
                                "coordinateSystem": "wgs84",
                                "nullable": false
                            }
                        }
                    },
                    "myCity",
                    {
                        "ns": "op",
                        "fn": "fragment-id-col",
                        "args": [
                            "fragId1"
                        ]
                    }
                ]
            },
            {
                "ns": "op",
                "fn": "join-inner",
                "args": [
                    {
                        "ns": "op",
                        "fn": "operators",
                        "args": [
                            {
                                "ns": "op",
                                "fn": "from-lexicons",
                                "args": [
                                    {
                                        "uri2": {
                                            "uriReference": { }
                                        },
                                        "cityName": {
                                            "jsonPropertyReference": {
                                                "property": "cityName",
                                                "scalarType": "string",
                                                "collation": "http://marklogic.com/collation/",
                                                "nullable": false
                                            }
                                        },
                                        "cityTeam": {
                                            "jsonPropertyReference": {
                                                "property": "cityTeam",
                                                "scalarType": "string",
                                                "collation": "http://marklogic.com/collation/",
                                                "nullable": false
                                            }
                                        }
                                    },
                                    "myTeam",
                                    {
                                        "ns": "op",
                                        "fn": "fragment-id-col",
                                        "args": [
                                            "fragId2"
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    null,
                    null
                ]
            },
            {
                "ns": "op",
                "fn": "where",
                "args": [
                    {
                        "ns": "op",
                        "fn": "eq",
                        "args": [
                            {
                                "ns": "op",
                                "fn": "viewCol",
                                "args": [
                                    "myCity",
                                    "city"
                                ]
                            },
                            {
                                "ns": "op",
                                "fn": "col",
                                "args": [
                                    "cityName"
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "ns": "op",
                "fn": "order-by",
                "args": [
                    [
                        {
                            "ns": "op",
                            "fn": "asc",
                            "args": [
                                {
                                    "ns": "op",
                                    "fn": "col",
                                    "args": [
                                        "date"
                                    ]
                                }
                            ]
                        }
                    ]
                ]
            }
        ]
    }
}